<template name="app">
	{{> loginButtons}}
	{{> Template.dynamic template=currentPage}}
</template>

<template name="feedPage">
	{{> leftSidebar}}
	{{> feed}}
</template>

<template name="createPage">
	{{> leftSidebar}}
	{{> createForm}}
</template>

<template name="createForm">
	<div id="createForm" class="main">
		<form>
			<fieldset>
				<label>Title</label>
				<input name="title" placeholder="Enter title">
				<label>Description</label>
				<textarea name="description" placeholder="Enter description"></textarea>
			</fieldset>
			<button id="create-button">Create</button>
		</form>
	</div>
</template>

<template name="leftSidebar">
	<div class="left-sidebar">
		<ul id="top-list">
			<li><a id="team-feed-link" href="/">Team Feed</a></li>
			<li><a id="create-link" href="/create">Create</a></li>
		</ul>
		<ul id="item-list">
			{{#each items}}
				{{> itemItemView}}
			{{/each}}
		</ul>

	</div>
</template>

<template name="feed">
	<div class="main">
		<header>
			{{#if isTeamFeed}}
				<div id="header-main-title">Team Feed</div>
			{{else}}
			<div id="header-main-title">{{currentItemTitle}} <span id="header-title-msg-count">{{currentItemMessageCount}}</span></div>
			{{#if hasIncomingMessages}}
				<a href="" id="header-new-messages-toast"><i class="fa fa-comments-o"></i> {{numIncomingMessages}} New Messages - click to show</a>
			{{/if}}
			{{/if}}
		</header>
		<ul id="message-list">
			<a href="" id="loading-more" style="visibility:{{#if moreMessagesOnServer}}visible{{else}}hidden{{/if}}"><i id="loading-more-icon" class="fa fa-spinner fa-pulse"></i></a>
			{{#each messages}}
			{{> messageItemView}}
			{{/each}}
		</ul>
		<footer class="{{#if isTeamFeed}}team-feed-banner{{/if}}">
			{{#if isTeamFeed}}
					<p>This is the team feed which is read only. To add a message select an item first.</p>
					<p>Eventually this will contain statistics about the project, but for now it's just a placeholder</p>
			{{else}}

				{{> messageBox}}
			{{/if}}
		</footer>
	</div>
</template>

<template name="messageBox">
	<textarea id="message-box"></textarea>
</template>

<template name="messageItemView">
	<li class="user-message" data-id={{_id}}>
		<strong>{{createdBy}}:</strong> {{title}} ({{messageDate}})
		<span id="meta">
			<span id="created-at">{{formatDate createdAt}}</span> <span id="item-link" class="{{showItemLink}}">in <a href="/item/{{itemId}}">{{itemTitle}}</a></span>
		</span>
	</li>
</template>

<template name="itemItemView">
	<li  data-id={{_id}}>
		<a class="item" href="/item/{{_id}}">
		<span id="title">{{title}}</span>
		<div id="description">{{description}}</div>
		</a>
	</li>
</template>
